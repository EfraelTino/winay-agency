---
import "@fontsource-variable/mona-sans";
import { SEO } from "astro-seo";

interface Props {
  title: string;
  description?: string;
  image?: string;
  noIndex?: boolean;
}

const { 
  title, 
  description = "Wiñay Agency: Multiplica tus ventas con estrategias digitales de alto rendimiento. Expertos en publicidad segmentada y conversión de leads.",
  image = "/favicon.webp",
  noIndex = false,
} = Astro.props;

const siteURL = "https://winayagency.com";

// --- FIX DEL ERROR ---
// Creamos variables auxiliares SOLO para pasarlas al componente SEO.
// Si 'title' viene vacío, usamos el nombre de la agencia para que no explote.
const seoTitle = title || "Wiñay Agency";
const seoImage = new URL(image, siteURL).href;
// --------------------
---

<!doctype html>
<html lang="es" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/png+xml" href="/favicon.webp" />
    <meta name="generator" content={Astro.generator} />

    <SEO
      title={seoTitle}
      titleTemplate="%s | Wiñay Agency"
      description={description}
      noindex={noIndex}
      openGraph={{
        basic: {
          title: seoTitle,   
          type: "website",
          image: seoImage,
        },
        image: {
            alt: "Wiñay Agency - Estrategia Digital"
        }
      }}
      twitter={{
        card: "summary_large_image",
        creator: "@winayagency"
      }}
    />

    <script type="application/ld+json" is:inline>
      {
        "@context": "https://schema.org",
        "@type": "ProfessionalService",
        "name": "Wiñay Agency",
        "url": "https://winayagency.com",
        "logo": "https://winayagency.com/favicon.webp",
        "image": "https://winayagency.com/favicon.webp",
        "description": "Agencia de marketing digital experta en embudos de venta y publicidad segmentada en Lima.",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Lima",
          "addressCountry": "PE"
        },
        "priceRange": "S/"
      }
    </script>

    <slot name="head" />
  </head>
  
  <body >
    <slot />
  </body>
</html>

<style is:global>
  /* Fuente Global */
  html {
    font-family: "Mona Sans Variable", sans-serif;
font-display: swap;
  }

  /* Scroll suave solo si el usuario no tiene activada la reducción de movimiento */
  @media (prefers-reduced-motion: no-preference) {
    html {
      scroll-behavior: smooth;
    }
  }
</style>